## Common prefixes.
@prefix rdf:              <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:             <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:              <http://www.w3.org/2002/07/owl#> .
@prefix foaf:             <http://xmlns.com/foaf/0.1/> .
@prefix xsd:              <http://www.w3.org/2001/XMLSchema#> .
@prefix api:              <http://purl.org/linked-data/api/vocab#> .
@prefix skos:             <http://www.w3.org/2004/02/skos/core#> .
@prefix geo:              <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> .
@prefix admingeo: 	    <http://statistics.data.gov.uk/def/administrative-geography/> .
@prefix qb:      	    <http://purl.org/linked-data/cube#> .
@prefix time:	 	    <http://www.w3.org/2006/time#> .
@prefix interval:         <http://reference.data.gov.uk/def/intervals/> .
@prefix dgu: 		    <http://reference.data.gov.uk/def/reference/> .
@prefix bw:               <http://environment.data.gov.uk/id/bathing-water/> .
@prefix bwsp:             <http://location.data.gov.uk/so/ef/SamplingPoint/bwsp.eaew/> .
@prefix bwq:  	          <http://environment.data.gov.uk/def/bathing-water-quality/> .
@prefix bwq-iss:          <http://environment.data.gov.uk/data/bathing-water-quality/in-season/slice/> .
@prefix bw_def:           <http://environment.data.gov.uk/def/bathing-water/> .
@prefix ef_def:           <http://location.data.gov.uk/def/ef/SamplingPoint/> .
@prefix dct:			  <http://purl.org/dc/terms/> .
@prefix t:                <http://environment.data.gov.uk/api#> .

t:api
	a api:API ;
	rdfs:label "Bathing Water Environment API"@en ;

	api:maxPageSize "100";
	api:defaultPageSize "10" ;
##  api:sparqlEndpoint <http://services.data.gov.uk/environment/sparql> ;
##	api:sparqlEndpoint <http://localhost:8080/bwqShell/sparql> ;
	api:sparqlEndpoint <http://gov.tso.co.uk/environment/sparql> ;
	api:defaultFormatter t:HtmlFormatter ;
	api:formatter t:CsvFormatter ;
	api:endpoint
		t:scheme ,
		t:definition ,
		t:subclasses , 
		t:instances , 
		t:properties ,
		t:bathingWater,
		t:bathingWaters,
		t:latestInSeasonAssessments,
		t:latestInSeasonAssessmentBySamplePoint,
		t:latestInSeasonAssessmentByBathingWater,
		t:individualInSeasonAssessment,
		t:inSeasonAssessments,
		t:inSeasonAssessmentsBySamplePoint,
		t:inSeasonAssessmentsByBathingWater,
		t:latestComplianceAssessments,
		t:latestComplianceAssessmentBySamplePoint,
		t:latestComplianceAssessmentByBathingWater,
		t:individualComplianceAssessment,
		t:complianceAssessments,
		t:complianceAssessmentsBySamplePoint,
		t:complianceAssessmentsByBathingWater,
		t:dataset,
		t:subsetDataset,
		t:inSeasonByWeekSlices,
		t:inSeasonByWeekSlice,
		t:inSeasonByYearSlices,
		t:inSeasonByYearSlice,
		t:inSeasonByPointYearSlices,
		t:inSeasonByPointYearSlice,
		t:inSeasonByPointSlices,
		t:inSeasonByPointSlice,
		t:complianceByYearSlices,
		t:complianceByYearSlice,
		t:complianceByPointSlices,
		t:complianceByPointSlice;
	.

#FORMATTERS

t:HtmlFormatter
  a api:XsltFormatter ;
  api:name "html" ;
  api:mimeType "text/html" , "application/xhtml+xml" ;
  api:stylesheet "xslt/environment.xsl" .

t:CsvFormatter
  a api:XsltFormatter ;
  api:name "csv" ;
  api:mimeType "text/csv" ;
  api:stylesheet "xslt/environment-csv.xsl" .

# Viewers #


##############################################################################################
## Definitions
##############################################################################################
t:scheme
  a api:ItemEndpoint ;
  api:uriTemplate "/def/{scheme}" ;
  api:itemTemplate "http://environment.data.gov.uk/def/{scheme}" ;
#  api:defaultViewer t:schemeViewer ;
  api:defaultViewer	api:describeViewer;

  .

t:schemeViewer
  a api:Viewer ;
  api:name "scheme" ;
  api:properties "name,type,alias,label,note,scopeNote,topConcept.name,comment" ;
  .

t:definition
  a api:ItemEndpoint ;
  api:uriTemplate "/def/{scheme}/{term}" ;
  api:itemTemplate "http://environment.data.gov.uk/def/{scheme}/{term}" ;
  api:defaultViewer t:definitionViewer ;
  .

t:definitionViewer
  a api:Viewer ;
  api:name "definition" ;
  api:properties "name,type,definition,alias,label,note,scopeNote,topConceptOf,broader.name,narrower.name,comment,range,domain,type.label,isDefinedBy.label,subClassOf.label,subPropertyOf.label" ;
  .

t:subclasses
  a api:ListEndpoint ;
  api:uriTemplate "/def/{scheme}/{term}/subclass" ;
  api:variable [
    api:name "superclass" ;
    api:value "http://environment.data.gov.uk/def/{scheme}/{term}" ;
    api:type rdfs:Resource ;
  ] ;
  api:selector [
    api:where " ?item rdfs:subClassOf ?superclass . " ;
  ] ;
  api:defaultViewer t:definitionViewer ;
  .

t:instances
  a api:ListEndpoint ;
  api:uriTemplate "/def/{scheme}/{term}/instance" ;
  api:variable [
    api:name "class" ;
    api:value "http://environment.data.gov.uk/def/{scheme}/{term}" ;
    api:type rdfs:Resource ;
  ] ;
  api:selector [
    api:where " ?item a ?class . " ;
  ] ;
  api:defaultViewer t:definitionViewer ;
  .

t:properties
  a api:ListEndpoint ;
  api:uriTemplate "/def/{scheme}/{term}/property" ;
  api:variable [
    api:name "class" ;
    api:value "http://environment.data.gov.uk/def/{scheme}/{term}" ;
    api:type rdfs:Resource ;
  ] ;
  api:selector [
    api:where " [] a ?class ; ?item [] . " ;
  ] ;
  api:defaultViewer t:definitionViewer ;
  .

##############################################################################################
## Bathing Waters
##############################################################################################
t:bathingWaters
  a api:ListEndpoint ;
  api:uriTemplate 		"/doc/bathing-water" ;
  api:exampleRequestPath 	"/doc/bathing-water" ;
  api:viewer
  	t:bathingWaterViewer,
	api:describeViewer;
  api:selector [
    api:filter "type=BathingWater" ;
    api:sort   "samplingPoint.samplePointNotation";
  ] ;
  api:defaultViewer t:bathingWaterViewer .

t:bathingWater
  a api:ItemEndpoint ;
  api:viewer
  	t:bathingWaterViewer,
	api:describeViewer;
  api:uriTemplate 		"/doc/bathing-water/{eubwid}" ;
  api:exampleRequestPath 	"/doc/bathing-water/ukc2102-03600" ;
  api:itemTemplate "http://environment.data.gov.uk/id/bathing-water/{eubwid}" ;
  api:defaultViewer t:bathingWaterViewer .

t:bathingWaterViewer
	a	            api:Viewer;
	api:name	      "bathing-water";
	api:properties	"name,eubwidNotation,samplingPoint.lat,samplingPoint.long,samplingPoint.easting,samplingPoint.northing" .

 
##############################################################################################
## In-Season Samples
##############################################################################################
t:inSeasonAssessments
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/in-season/sample" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/sample" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "type=SampleAssessment";
    api:sort "sampleDateTime.inXSDDateTime,bwq_samplingPoint.samplePointNotation";
  ] ;
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:inSeasonAssessmentValuesViewer;
  .

##############################################################################################
## Top-level dataset
##############################################################################################
t:dataset 
  a	api:ItemEndpoint;
  api:uriTemplate			"/data/bathing-water-quality" ;
  api:exampleRequestPath	"/data/bathing-water-quality" ;
  api:itemTemplate 			"http://environment.data.gov.uk/data/bathing-water-quality" ;
  api:viewer
  	api:describeViewer;
  api:defaultViewer	api:describeViewer;
  .  

##############################################################################################
## subset datasets
##############################################################################################
t:subsetDataset 
  a	api:ItemEndpoint;
  api:uriTemplate			"/data/bathing-water-quality/{dataset}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season" ;
  api:itemTemplate 			"http://environment.data.gov.uk/data/bathing-water-quality/{dataset}" ;
  api:viewer
  	api:describeViewer ;
  api:defaultViewer	api:describeViewer;
  .  

##############################################################################################
## Individual In-Season Sample Assessments
##############################################################################################
t:individualInSeasonAssessment
  a	api:ItemEndpoint;
  api:uriTemplate			"/data/bathing-water-quality/in-season/sample/point/{bwspid}/date/{date}/time/{time}/recordDate/{recDate}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/sample/point/38660/date/20100917/time/110500/recordDate/20110111" ;
  api:itemTemplate 			"http://environment.data.gov.uk/data/bathing-water-quality/in-season/sample/point/{bwspid}/date/{date}/time/{time}/recordDate/{recDate}" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:inSeasonAssessmentValuesViewer;
  .
##############################################################################################
## In-Season Samples by Sampling Point
##############################################################################################
t:inSeasonAssessmentsBySamplePoint
  a	api:ListEndpoint;
  api:uriTemplate			    "/doc/bathing-water-quality/in-season/point/{bwspid}" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/point/03600" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "bwq_samplingPoint.samplePointNotation={bwspid}&type=SampleAssessment";
    api:sort "sampleDateTime.inXSDDateTime";
  ] ;
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:inSeasonAssessmentValuesViewer;
  .
##############################################################################################
## In-Season Samples by Bathing Water
##############################################################################################
t:inSeasonAssessmentsByBathingWater
  a	api:ListEndpoint;
  api:uriTemplate			    "/doc/bathing-water-quality/in-season/bathing-water/{eubwid}" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/bathing-water/ukc2102-03600" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "bwq_bathingWater.eubwidNotation={eubwid}&type=SampleAssessment";
    api:sort "sampleDateTime.inXSDDateTime";
  ] ;
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:inSeasonAssessmentValuesViewer;
  .

##############################################################################################
## Lastest In-Season Samples
##############################################################################################
t:latestInSeasonAssessments
  a	api:ListEndpoint;
  api:uriTemplate			    "/doc/bathing-water-quality/in-season/latest" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/latest" ;
  api:defaultPageSize			"10";
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:selector [
    api:where	"bwq-iss:latest qb:observation ?item .";
    api:sort	"sampleWeek.label,bwq_bathingWater.name";
  ] ;
  api:defaultViewer	t:inSeasonAssessmentViewer;
  .
 
##############################################################################################
# Latest in-season sample assessment by sampling point.
##############################################################################################
t:latestInSeasonAssessmentBySamplePoint
  a	api:ListEndpoint;
  api:uriTemplate			    "/doc/bathing-water-quality/in-season/point/{bwspid}/latest" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/point/19100/latest" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:defaultPageSize		"1";
  api:maxPageSize 		"1";
  api:selector [
  	  	api:where  "bwq-iss:latest qb:observation ?item .";
  		api:filter "bwq_samplingPoint.samplePointNotation={bwspid}&type=SampleAssessment";
  		api:sort	"-sampleDateTime";
  ];
  api:defaultViewer	t:inSeasonAssessmentViewer;
  .

##############################################################################################
# Latest in-season sample assessment by bathing water.
##############################################################################################
t:latestInSeasonAssessmentByBathingWater
  a	api:ListEndpoint;
  api:uriTemplate			    "/doc/bathing-water-quality/in-season/bathing-water/{eubwid}/latest" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/in-season/bathing-water/ukc2102-03600/latest" ;
  api:viewer
	t:inSeasonAssessmentViewer,
	t:inSeasonAssessmentValuesViewer,
	t:inSeasonClassificationViewer,
	t:inSeasonColiformCountViewer,
	t:inSeasonStreptococciCountViewer,
	t:inSeasonEntrovirusCountViewer,
	t:inSeasonSalmonellaPresentViewer,
	api:describeViewer; 
  api:defaultPageSize		"1";
  api:maxPageSize 		"1";
  api:selector [
  	  	api:where  "bwq-iss:latest qb:observation ?item .";
  		api:filter "bwq_bathingWater.eubwidNotation={eubwid}&type=SampleAssessment";
  		api:sort	"-sampleDateTime";
  ];
  api:defaultViewer	t:inSeasonAssessmentViewer;
  .
  
##############################################################################################
# In-season sample assessment viewers 
##############################################################################################
t:inSeasonAssessmentViewer
	a				api:Viewer;
	api:name		"location";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,sampleClassification.complianceCodeNotation,sampleClassification.name,totalColiformQualifier.countQualifierNotation,totalColiformCount,faecalColiformQualifier.countQualifierNotation,faecalColiformCount,faecalStreptococciQualifier.countQualifierNotation,faecalStreptococciCount,entrovirusQualifier.countQualifierNotation,entrovirusCount,salmonellaPresent.name,salmonellaPresent.presenceNotation,abnormalWeatherException" .
	
t:inSeasonAssessmentValuesViewer
	a				api:Viewer;
	api:name		"assessment";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,sampleClassification.complianceCodeNotation,sampleClassification.name,totalColiformQualifier.countQualifierNotation,totalColiformCount,faecalColiformQualifier.countQualifierNotation,faecalColiformCount,faecalStreptococciQualifier.countQualifierNotation,faecalStreptococciCount,entrovirusQualifier.countQualifierNotation,entrovirusCount,salmonellaPresent.name,salmonellaPresent.presenceNotation,abnormalWeatherException" .
	
t:inSeasonClassificationViewer
	a				api:Viewer;
	api:name		"classification";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,sampleClassification.complianceCodeNotation,sampleClassification.name,abnormalWeatherException" .
	
t:inSeasonColiformCountViewer
	a				api:Viewer;
	api:name		"coliforms";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,totalColiformQualifier.countQualifierNotation,totalColiformCount,faecalColiformQualifier.countQualifierNotation,faecalColiformCount,abnormalWeatherException" .

t:inSeasonStretococciCountViewer
	a				api:Viewer;
	api:name		"streptococci";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,faecalStreptococciQualifier.countQualifierNotation,faecalStreptococciCount,abnormalWeatherException" .
	
t:inSeasonEntrovirusCountViewer
	a				api:Viewer;
	api:name		"entrovirus";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,entrovirusQualifier.countQualifierNotation,entrovirusCount,abnormalWeatherException" .

t:inSeasonSalmonellaPresentViewer
	a				api:Viewer;
	api:name		"salmonella";
	api:properties	"label,source,dataset,bwq_samplingPoint.name,bwq_bathingWater.name,sampleDateTime.inXSDDateTime,sampleWeek.label,salmonellaPresent.name,salmonellaPresent.presenceNotation,abnormalWeatherException" .

##############################################################################################
## In-season slices
##############################################################################################
#
# ByWeekSlice
#
t:inSeasonByWeekSlices
  a api:ListEndpoint ;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/week" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/week" ;
  api:viewer	
  	t:sliceByWeekListViewer,
  	api:describeViewer;
  api:selector [
    api:filter "type=ByWeekSlice" ;
    api:sort   "sampleWeek.ordinalWeekOfYearYear,sampleWeek.ordinalWeekOfYear";
  ] ;
  api:defaultViewer t:sliceByWeekListViewer .
  
t:inSeasonByWeekSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:sliceByWeekItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/week/{week}" ;
  api:itemTemplate 		    "http://environment.data.gov.uk/data/bathing-water-quality/in-season/slice/week/{week}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/week/1998-W24" ;
  api:defaultViewer 		t:sliceByWeekItemViewer .

t:sliceByWeekListViewer
	a			api:Viewer;
	api:name	"slice-by-week";
	api:properties	"name,label,sampleWeek.ordinalWeekOfYear,sampleWeek.ordinalWeekOfYearYear,bwq_samplingPoint,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,,bwq_samplingPoint.lat,bwq_samplingPoint.long";
	.
	
t:sliceByWeekItemViewer
	a			api:Viewer;
	api:name	"slice-by-week";
	api:properties	"name,label,observation.bwq_bathingWater.name";
	.

#
# ByYearSlice
#
t:inSeasonByYearSlices
  a api:ListEndpoint ;
  api:viewer	
  	t:sliceByYearListViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/year" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/year" ;
  api:selector [
    api:filter "type=ByYearSlice" ;
    api:sort   "sampleYear.ordinalYear";
  ] ;
  api:defaultViewer t:sliceByYearListViewer .
  
t:inSeasonByYearSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:sliceByYearItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/year/{year}" ;
  api:itemTemplate			"http://environment.data.gov.uk/data/bathing-water-quality/in-season/slice/year/{year}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/year/1998" ;
#  api:defaultViewer 		t:sliceByYearItemViewer;
  api:defaultViewer api:describeViewer; 
  .
  
t:sliceByYearListViewer
	a			api:Viewer;
	api:name	"slice-by-year";
	api:properties	"name,label,sampleYear.ordinalYear,bwq_samplingPoint,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,,bwq_samplingPoint.lat,bwq_samplingPoint.long";
	.
	
t:sliceByYearItemViewer
	a			api:Viewer;
	api:name	"slice-by-year";
	api:properties	"name,label,bwq_samplingPoint.name,observation.sampleWeek.label";
	.
#
# BySamplingPointYearSlice
#
t:inSeasonByPointYearSlices
  a api:ListEndpoint ;
  api:viewer	
  	t:sliceByPointYearListViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/point-year" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/point-year" ;
  api:selector [
    api:filter "type=BySamplingPointYearSlice" ;
    api:sort   "sampleYear.ordinalYear,bwq_samplingPoint.samplePointNotation";
  ] ;
  api:defaultViewer t:sliceByPointYearListViewer .
  
t:inSeasonByPointYearSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:sliceByPointYearItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/point/{point}/year/{year}" ;
  api:itemTemplate			"http://environment.data.gov.uk/data/bathing-water-quality/in-season/slice/point/{point}/year/{year}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/point/03600/year/1998" ;
  api:defaultViewer 		t:sliceByPointYearItemViewer; 
  .
  
t:sliceByPointYearListViewer
	a			api:Viewer;
	api:name	"slice-by-point-and-year";
	api:properties	"name,label,sampleYear.ordinalYear,bwq_samplingPoint,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long";
	.

t:sliceByPointYearItemViewer
	a			api:Viewer;
	api:name	"slice-by-point-year";
	api:properties	"name,label,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long,observation.sampleWeek.label";
	.
#
# BySamplingPointSlice
#
t:inSeasonByPointSlices
  a api:ListEndpoint ;
  api:viewer	
  	t:sliceByPointListViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/point" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/point" ;
  api:selector [
    api:filter "type=BySamplingPointSlice" ;
    api:sort   "bwq_samplingPoint.samplePointNotation";
  ] ;
  api:defaultViewer t:sliceByPointListViewer .
  
t:inSeasonByPointSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:sliceByPointItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/in-season/slice/point/{point}" ;
  api:itemTemplate			"http://environment.data.gov.uk/data/bathing-water-quality/in-season/slice/point/{point}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/in-season/slice/point/03600" ;
  api:defaultViewer 		t:sliceByPointItemViewer; 
  .
  
t:sliceByPointListViewer
	a			api:Viewer;
	api:name	"slice-by-point";
	api:properties	"name,label,bwq_samplingPoint,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long";
	.

t:sliceByPointItemViewer
	a			api:Viewer;
	api:name	"slice-by-point";
	api:properties	"name,label,bwq_samplingPoint.name,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long,observation.sampleWeek.label";
	.

##############################################################################################
## Annual Compliance Samples
##############################################################################################
t:complianceAssessments
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/compliance" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/compliance" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "type=ComplianceAssessment";
    api:sort "sampleYear.ordinalYear,bwq_samplingPoint.samplePointNotation";
  ] ;
  api:defaultViewer	t:complianceAssessmentViewer;
  .

##############################################################################################
## Individual Annual Compliance Assessments
##############################################################################################
t:individualComplianceAssessment
  a	api:ItemEndpoint;
  api:uriTemplate			    "/data/bathing-water-quality/compliance/point/{bwspid}/year/{year}" ;
  api:exampleRequestPath		"/data/bathing-water-quality/compliance/point/03600/year/2010" ;
  api:itemTemplate 				"http://environment.data.gov.uk/data/bathing-water-quality/compliance/point/{bwspid}/year/{year}" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:complianceAssessmentViewer;
  .
##############################################################################################
## Annual Compliance Assessment by Sampling Point
##############################################################################################
t:complianceAssessmentsBySamplePoint
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/compliance/point/{bwspid}" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/compliance/point/03600" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "bwq_samplingPoint.samplePointNotation={bwspid}&type=ComplianceAssessment";
    api:sort "sampleYear.ordinalYear";
  ] ;
  api:defaultViewer	t:complianceAssessmentViewer;
  .
##############################################################################################
## Annual Compliance Assessment by Bathing Water
##############################################################################################
t:complianceAssessmentsByBathingWater
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/compliance/bathing-water/{eubwid}" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/compliance/bathing-water/ukc2102-03600" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:defaultPageSize		"10";
  api:selector [
    api:filter "bwq_bathingWater.eubwidNotation={eubwid}&type=ComplianceAssessment";
    api:sort "sampleYear.ordinalYear";
  ] ;
#  api:defaultViewer	api:describeViewer;
  api:defaultViewer	t:complianceAssessmentViewer;
  .

##############################################################################################
## Lastest Annual Compliance Assessments
##############################################################################################
t:latestComplianceAssessments
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/compliance/latest" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/compliance/latest" ;
  api:defaultPageSize			"10";
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:selector [
    api:where	
"""
?slice a bwq:ComplianceByYearSlice;
       bwq:sampleYear [interval:ordinalYear ?year] .

# Find the most recent annual compliance slice
OPTIONAL {
  ?slice2 a bwq:ComplianceByYearSlice;
          bwq:sampleYear [ interval:ordinalYear ?year2 ] .
  FILTER (?year2>?year)          
} FILTER (!bound(?slice2))
?slice qb:observation ?item .
""";
    api:sort	"sampleYear.ordinalYear,bwq_bathingWater.name";
  ] ;
  api:defaultViewer	t:complianceAssessmentViewer;
  .
 
##############################################################################################
# Latest Annual Compliance Assessment by sampling point.
##############################################################################################
t:latestComplianceAssessmentBySamplePoint
  a	api:ListEndpoint;
  api:uriTemplate			"/doc/bathing-water-quality/compliance/point/{bwspid}/latest" ;
  api:exampleRequestPath	"/doc/bathing-water-quality/compliance/point/19100/latest" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:defaultPageSize		"1";
  api:maxPageSize 		"1";
  api:selector [
  		api:filter "bwq_samplingPoint.samplePointNotation={bwspid}&type=ComplianceAssessment";
  		api:sort	"-sampleYear.ordinalYear";
  ];
  api:defaultViewer	t:complianceAssessmentViewer;
  .

t:complianceAssessmentViewer
	a				api:Viewer;
	api:name		"compliance";
	api:properties	"label,bwq_samplingPoint.name,bwq_samplingPoint.samplePointNotation,bwq_samplingPoint.easting,bwq_samplingPoint.northing,bwq_samplingPoint.lat,bwq_samplingPoint.long,bwq_bathingWater.name,bwq_bathingWater.eubwidNotation,sampleYear.ordinalYear,complianceClassification.complianceCodeNotation,complianceClassification.name" .


##############################################################################################
# Latest compliance assessment by bathing water.
##############################################################################################
t:latestComplianceAssessmentByBathingWater
  a	api:ListEndpoint;
  api:uriTemplate				"/doc/bathing-water-quality/compliance/bathing-water/{eubwid}/latest" ;
  api:exampleRequestPath		"/doc/bathing-water-quality/compliance/bathing-water/ukc2102-03600/latest" ;
  api:viewer
	t:complianceAssessmentViewer,
	api:describeViewer; 
  api:defaultPageSize		"1";
  api:maxPageSize 		"1";
  api:selector [
  		api:filter "bwq_bathingWater.eubwidNotation={eubwid}&type=ComplianceAssessment";
  		api:sort	"-sampleDateTime";
  ];
  api:defaultViewer	t:complianceAssessmentViewer;
  .  

##############################################################################################
# Compliance assessment slices
##############################################################################################

#
# ByYearSlice
#
t:complianceByYearSlices
  a api:ListEndpoint ;
  api:viewer	
  	t:complianceByYearListViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/compliance/slice/year" ;
  api:exampleRequestPath	"/data/bathing-water-quality/compliance/slice/year" ;
  api:selector [
    api:filter "type=ComplianceByYearSlice" ;
    api:sort   "sampleYear.ordinalYear";
  ] ;
  api:defaultViewer t:complianceByYearListViewer .
  
t:complianceByYearSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:complianceByYearItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/compliance/slice/year/{year}" ;
  api:itemTemplate			"http://environment.data.gov.uk/data/bathing-water-quality/compliance/slice/year/{year}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/compliance/slice/year/1998" ;
  api:defaultViewer t:complianceByYearItemViewer; 
  .
  
t:complianceByYearListViewer
	a				api:Viewer;
	api:name		"slice-by-year";
	api:properties	"name,label,sampleYear.ordinalYear";
	.
	
t:complianceByYearItemViewer
	a				api:Viewer;
	api:name		"slice-by-year";
	api:properties	"name,label,observation.bwq_bathingWater.name,observation.complianceClassification.name";
	.

#
# BySamplingPointSlice
#
t:complianceByPointSlices
  a api:ListEndpoint ;
  api:viewer	
  	t:complianceByPointListViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/compliance/slice/point" ;
  api:exampleRequestPath	"/data/bathing-water-quality/compliance/slice/point" ;
  api:selector [
    api:filter "type=ComplianceBySamplingPointSlice" ;
    api:sort   "bwq_samplingPoint.samplePointNotation";
  ] ;
  api:defaultViewer t:complianceByPointListViewer .
  
t:complianceByPointSlice
  a api:ItemEndpoint ;
  api:viewer	
  	t:complianceByPointItemViewer,
  	api:describeViewer;
  api:uriTemplate			"/data/bathing-water-quality/compliance/slice/point/{point}" ;
  api:itemTemplate			"http://environment.data.gov.uk/data/bathing-water-quality/compliance/slice/point/{point}" ;
  api:exampleRequestPath	"/data/bathing-water-quality/compliance/slice/point/03600" ;
  api:defaultViewer t:complianceByPointItemViewer; 
  .
  
t:complianceByPointListViewer
	a				api:Viewer;
	api:name		"slice-by-point";
	api:properties	"name,label,bwq_bathingWater.name";
	.
	
t:complianceByPointItemViewer
	a				api:Viewer;
	api:name		"slice-by-point";
	api:properties	"name,label,observation.sampleYear.ordinalYear,observation.complianceClassification.name";
	.
##############################################################################################
# Labels
##############################################################################################

# Common #

rdf:Property api:label "Property" .

rdf:type api:label "type" ; api:multiValued true .
rdf:value api:label "value" .

rdfs:Class api:label "Class" .

rdfs:label   api:label "label" ; api:multiValued true .
rdfs:seeAlso api:label "seeAlso" ; api:multiValued true .
rdfs:comment api:label "comment" .
rdfs:range   api:label "range" .
rdfs:domain  api:label "domain" .
rdfs:isDefinedBy api:label "isDefinedBy" .
rdfs:subClassOf api:label "subClassOf" .
rdfs:subPropertyOf api:label "subPropertyOf" .

owl:sameAs api:label "sameAs" .

skos:Concept api:label "Concept" .
skos:ConceptScheme api:label "ConceptScheme" .

skos:prefLabel 	api:label "name" .
skos:altLabel 	api:label "alias" ; api:multiValued true .
skos:note 		api:label "note" .
skos:notation 	a owl:DatatypeProperty; api:label "notation"  .
skos:scopeNote 	api:label "scopeNote" .
skos:topConceptOf api:label "topConceptOf" .
skos:hasTopConcept api:label "topConcept" ; api:multiValued true .
skos:broader 	api:label "broader" .
skos:narrower 	api:label "narrower" ; api:multiValued true .
skos:definition	api:label "definition" ; api:multiValued true .

dgu:uriSet api:label "uriSet" .

geo:lat
  a	owl:DatatypeProperty;
  api:label "lat" ;
  rdfs:range xsd:decimal .
  
geo:long
  a owl:DatatypeProperty;
  api:label "long" ;
  rdfs:range xsd:decimal .

spatialrelations:easting 
  a owl:DatatypeProperty ;
  api:label "easting" ;
#  rdfs:range xsd:integer;
  rdfs:range xsd:decimal;
  .
  
spatialrelations:northing 
  a owl:DatatypeProperty ;
  api:label "northing" ;
#  rdfs:range xsd:integer;
  rdfs:range xsd:decimal;
  .

spatialrelations:containedBy api:label "containedBy" .
spatialrelations:contains api:label "contains" .
spatialrelations:borders api:label "borders" .

admingeo:country api:label "countryAdmingeo" .
admingeo:region api:label "regionAdmingeo" .
admingeo:localAuthority api:label "localAuthority" .
admingeo:district api:label "district" .
admingeo:coverage api:label "coverage" .
admingeo:standardCode
  a owl:DatatypeProperty ;
  api:label "snac" ;
  rdfs:range admingeo:StandardCode .

admingeo:LocalAuthority api:label "LocalAuthority" .
admingeo:LocalAuthorityDistrict api:label "LocalAuthorityDistrict" .

admingeo:StandardCode a rdfs:Datatype .

# DC Terms
dct:source api:label "source" .

# cube 
qb:dataset	api:label "dataset" .
qb:observation api:label "observation" .

# Bathing Waters #

bw_def:BathingWater	api:label	 "BathingWater" .
bw_def:bathingWater   api:label   "bathingWater" .
bw_def:eubwidNotation api:label   "eubwidNotation";
			 	rdfs:range  bw_def:eubwid .

ef_def:samplingPoint api:label  "samplingPoint" .
ef_def:SamplingPoint api:label  "SamplingPoint" .

ef_def:samplePointNotation a owl:DatatypeProperty;
                           rdfs:range   ef_def:samplePointCode;
                           api:label	"samplePointNotation" .
                           

bwq:SampleAssessment api:label  "SampleAssessment" .
bwq:ComplianceAssessment api:label  "ComplianceAssessment" .

bwq:sampleDateTime	 a			owl:ObjectProperty;
					 api:label  "sampleDateTime"; 
					 rdfs:range	time:Instant;
					 .
bwq:sampleWeek	 	 a			owl:ObjectProperty;
				 	 api:label  "sampleWeek"; 
				 	 rdfs:range	time:Interval;
				 	 .
				 	 
bwq:sampleYear	 	 a			owl:ObjectProperty;
					 api:label  "sampleYear";
					 rdfs:range	time:Interval;
				 	 .

bwq:samplingPoint    api:label  "bwq_samplingPoint" .
bwq:bathingWater     api:label  "bwq_bathingWater" .

bwq:ByWeekSlice		 api:label  "ByWeekSlice" .
bwq:ByYearSlice		 api:label  "ByYearSlice" .
bwq:BySamplingPointYearSlice
					 api:label  "BySamplingPointYearSlice" .

bwq:BySamplingPointSlice
					 api:label  "BySamplingPointSlice" .

bwq:ComplianceBySamplingPointSlice
					 api:label  "ComplianceBySamplingPointSlice" .

bwq:ComplianceByYearSlice
					 api:label  "ComplianceByYearSlice" .

bwq:sampleClassification api:label "sampleClassification" .
bwq:complianceClassification api:label "complianceClassification" .

bwq:complianceCodeNotation a			owl:DatatypeProperty;
                           api:label	"complianceCodeNotation";
                           rdfs:range	bwq:complianceCode .
                           
bwq:complianceCode api:label "complianceCode" .

bwq:countQualifierNotation	a		owl:DatatypeProperty;
							api:label	"countQualifierNotation";
							rdfs:range	bwq:countQualiferCode;
							.

bwq:totalColiformCount     api:label     "totalColiformCount" .
bwq:totalColiformQualifier api:label "totalColiformQualifier" .

bwq:faecalColiformCount 		api:label "faecalColiformCount" .
bwq:faecalColiformQualifier 	api:label "faecalColiformQualifier" .

bwq:faecalStreptococciCount 	api:label "faecalStreptococciCount" .
bwq:faecalStreptococciQualifier api:label "faecalStreptococciQualifier" .

bwq:entrovirusCount 			api:label "entrovirusCount" .
bwq:entrovirusQualifier 		api:label "entrovirusQualifier" .

bwq:salmonellaPresent			api:label	"salmonellaPresent" .
bwq:presenceNotation			a			owl:DatatypeProperty;
								api:label	"presenceNotation";
								rdfs:range	bwq:presenceCode .
								
bwq:abnormalWeatherException	api:label	"abnormalWeatherException" .

rdf:value api:label "value" ;
  rdfs:range xsd:integer .
  
time:inXSDDateTime				api:label	"inXSDDateTime" .

interval:ordinalYear			a		owl:DatatypeProperty;
								rdfs:range	xsd:integer;
								api:label	"ordinalYear" .
  
interval:ordinalWeekOfYear		a		owl:DatatypeProperty;
								rdfs:range	xsd:integer;
								api:label	"ordinalWeekOfYear" .
								
interval:ordinalWeekOfYearYear
								a		owl:DatatypeProperty;
								rdfs:range	xsd:integer;
								api:label	"ordinalWeekOfYearYear" .  
